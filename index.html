<link href="css/test.css" rel="stylesheet">
<script src="js/three.min.js"></script>
<script src="js/panolens.min.js"></script>

<div id="progress">
  <div id="bar"></div>
</div>
<div id="container"></div>
<button id="controlButton" class="button">Test Control</button>
<button id="modeButton" class="button">Test Mode</button>
<button id="videoButton" class="button">Test Play Video</button>
<button id="btn1" class="button">Switch image</button>
<button id="btn2" class="button">Switch video</button>

<script>
var panorama, panorama2, viewer, container, infospot, controlButton, modeButton, videoButton;

var controlIndex = PANOLENS.CONTROLS.DEVICEORIENTATION;
var modeIndex = 0;
var videoPlaying = false;
var bar = document.querySelector( '#bar' );

function onProgressUpdate ( event ) {
  var percentage = event.progress.loaded/ event.progress.total * 100;
  bar.style.width = percentage + "%";
  if (percentage >= 100){
    bar.classList.add( 'hide' );
    setTimeout(function(){
      bar.style.width = 0;
    }, 1000);
  }
}

container = document.querySelector( '#container' );
controlButton = document.querySelector( '#controlButton' );
modeButton = document.querySelector( '#modeButton' );
videoButton = document.querySelector( '#videoButton' );
var button1 = document.querySelector( '#btn1' );
var button2 = document.querySelector( '#btn2' );

panorama = new PANOLENS.ImagePanorama( 'https://arko24.github.io/virtu.github.io/media/building.jpg' );

panorama2 = new PANOLENS.VideoPanorama( 'https://arko24.github.io/virtu.github.io/media/ClashofClans.mp4' );

infospot = new PANOLENS.Infospot( 350, PANOLENS.DataImage.Info );
infospot.position.set( 0, -2000, -5000 );

panorama.add( infospot );

viewer = new PANOLENS.Viewer( { container: container } );
viewer.add( panorama, panorama2 );

// Method to trigger control
controlButton.addEventListener( 'click', function(){

  controlIndex = controlIndex >= 1 ? 0 : controlIndex + 1;
  
  switch ( controlIndex ) {
      
    case 0: viewer.enableControl( PANOLENS.CONTROLS.ORBIT ); break;
    case 1: viewer.enableControl( PANOLENS.CONTROLS.DEVICEORIENTATION ); break;
    default: break;
      
  }

} );

modeButton.addEventListener( 'click', function(){
  
  modeIndex = modeIndex >= 2 ? 0 : modeIndex + 1;
  
  switch ( modeIndex ) {
      
    case 0: viewer.disableEffect(); break;
    case 1: viewer.enableEffect( PANOLENS.MODES.CARDBOARD ); break;
    case 2: viewer.enableEffect( PANOLENS.MODES.STEREO ); break;
    default: break;
      
  }

} );

// if it's video panorama
videoButton.addEventListener( 'click', function(){
  
  videoPlaying = !videoPlaying;
  viewer.toggleVideoPlay( videoPlaying ? false : true );
  
} );

// Maunal Set Panorama


// Enter panorama when load completes
function onButtonClick( targetPanorama ) {
  bar.classList.remove( 'hide' );
  viewer.setPanorama( targetPanorama );
}

button1.addEventListener( 'click', onButtonClick.bind( this, panorama ) );

button2.addEventListener( 'click', onButtonClick.bind( this, panorama2 ) );


</script>